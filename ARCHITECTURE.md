# ğŸ›ï¸ NotesVerb Microservices Architecture

## ğŸ“Š System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                            â”‚
â”‚  (Web Browser, Mobile App, REST Client)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTP/HTTPS
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API GATEWAY (Port 8080)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â€¢ Request Routing                                        â”‚   â”‚
â”‚  â”‚ â€¢ Authentication & Authorization                         â”‚   â”‚
â”‚  â”‚ â€¢ Rate Limiting (TODO)                                   â”‚   â”‚
â”‚  â”‚ â€¢ Request/Response Logging                               â”‚   â”‚
â”‚  â”‚ â€¢ CORS & Security Headers                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚              â”‚              â”‚              â”‚
    â–¼              â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTH    â”‚  â”‚  USER    â”‚  â”‚  NOTE    â”‚  â”‚   TAG    â”‚
â”‚ SERVICE  â”‚  â”‚ SERVICE  â”‚  â”‚ SERVICE  â”‚  â”‚ SERVICE  â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ Port     â”‚  â”‚ Port     â”‚  â”‚ Port     â”‚  â”‚ Port     â”‚
â”‚ 3001     â”‚  â”‚ 3002     â”‚  â”‚ 3003     â”‚  â”‚ 3004     â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚Registerâ”‚  â”‚ â”‚Profileâ”‚  â”‚ â”‚Createâ”‚ â”‚  â”‚ â”‚Createâ”‚ â”‚
â”‚ â”‚Login  â”‚ â”‚  â”‚ â”‚Updateâ”‚ â”‚  â”‚ â”‚Read  â”‚ â”‚  â”‚ â”‚List  â”‚ â”‚
â”‚ â”‚Refreshâ”‚ â”‚  â”‚ â”‚Deleteâ”‚ â”‚  â”‚ â”‚Updateâ”‚ â”‚  â”‚ â”‚Attachâ”‚ â”‚
â”‚ â”‚Logout â”‚ â”‚  â”‚ â”‚Get   â”‚ â”‚  â”‚ â”‚Deleteâ”‚ â”‚  â”‚ â”‚Removeâ”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚              â”‚              â”‚
     â”‚             â”‚              â”‚              â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   SHARED LAYER (@shared)    â”‚
     â”‚                             â”‚
     â”‚ â€¢ Types & Interfaces        â”‚
     â”‚ â€¢ Middlewares               â”‚
     â”‚ â€¢ Utilities                 â”‚
     â”‚ â€¢ Common Functions          â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                            â”‚
     â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   POSTGRESQL     â”‚    â”‚      REDIS       â”‚
â”‚   (Port 5432)    â”‚    â”‚   (Port 6379)    â”‚
â”‚                  â”‚    â”‚                  â”‚
â”‚ Schemas:         â”‚    â”‚ â€¢ Sessions       â”‚
â”‚  â€¢ auth          â”‚    â”‚ â€¢ Cache          â”‚
â”‚  â€¢ user          â”‚    â”‚ â€¢ Rate Limiting  â”‚
â”‚  â€¢ note          â”‚    â”‚                  â”‚
â”‚  â€¢ tag           â”‚    â”‚                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow Example

### Example: Create a Note

```
1. Client Request
   POST http://localhost:8080/api/notes
   Headers: Authorization: Bearer <token>
   Body: { "title": "My Note", "content": "..." }
   
   â†“

2. API Gateway (Port 8080)
   â€¢ Receives request
   â€¢ Validates JWT token
   â€¢ Extracts user info (userId, email)
   â€¢ Adds headers: x-user-id, x-user-email
   â€¢ Routes to Note Service
   
   â†“

3. Note Service (Port 3003)
   â€¢ Receives proxied request
   â€¢ Validates input (Joi)
   â€¢ Checks authorization
   â€¢ Creates note in database
   â€¢ Returns response
   
   â†“

4. Response Flow
   Note Service â†’ API Gateway â†’ Client
   Status: 201 Created
   Body: { "success": true, "data": { note } }
```

---

## ğŸ—‚ï¸ Database Schema Design

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               PostgreSQL Database                        â”‚
â”‚               notesverb_db                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚              â”‚              â”‚             â”‚
â”‚  Schema:    â”‚  Schema:     â”‚  Schema:     â”‚  Schema:    â”‚
â”‚  auth       â”‚  user        â”‚  note        â”‚  tag        â”‚
â”‚             â”‚              â”‚              â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚UserAuth â”‚ â”‚ â”‚UserProfile â”‚ â”‚Note    â”‚  â”‚ â”‚Tag    â”‚  â”‚
â”‚ â”‚         â”‚ â”‚ â”‚          â”‚  â”‚ â”‚        â”‚  â”‚ â”‚       â”‚  â”‚
â”‚ â”‚id       â”‚ â”‚ â”‚id        â”‚  â”‚ â”‚id      â”‚  â”‚ â”‚id     â”‚  â”‚
â”‚ â”‚email    â”‚ â”‚ â”‚userId    â”‚  â”‚ â”‚title   â”‚  â”‚ â”‚name   â”‚  â”‚
â”‚ â”‚password â”‚ â”‚ â”‚firstName â”‚  â”‚ â”‚content â”‚  â”‚ â”‚color  â”‚  â”‚
â”‚ â”‚         â”‚ â”‚ â”‚lastName  â”‚  â”‚ â”‚userId  â”‚  â”‚ â”‚userId â”‚  â”‚
â”‚ â”‚         â”‚ â”‚ â”‚bio       â”‚  â”‚ â”‚        â”‚  â”‚ â”‚       â”‚  â”‚
â”‚ â”‚         â”‚ â”‚ â”‚avatarUrl â”‚  â”‚ â”‚        â”‚  â”‚ â”‚       â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â”‚
â”‚             â”‚              â”‚      â”‚       â”‚     â”‚      â”‚
â”‚             â”‚              â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”˜      â”‚
â”‚             â”‚              â”‚   NoteTags   â”‚            â”‚
â”‚             â”‚              â”‚   (Join)     â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ³ Docker Container Structure

```
Docker Compose Network: notesverb-network
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚   Auth      â”‚  â”‚    User     â”‚  â”‚    Note     â”‚    â”‚
â”‚  â”‚  Container  â”‚  â”‚  Container  â”‚  â”‚  Container  â”‚    â”‚
â”‚  â”‚             â”‚  â”‚             â”‚  â”‚             â”‚    â”‚
â”‚  â”‚  Node.js    â”‚  â”‚  Node.js    â”‚  â”‚  Node.js    â”‚    â”‚
â”‚  â”‚  Alpine     â”‚  â”‚  Alpine     â”‚  â”‚  Alpine     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Tag      â”‚  â”‚      API Gateway             â”‚    â”‚
â”‚  â”‚  Container  â”‚  â”‚      Container               â”‚    â”‚
â”‚  â”‚             â”‚  â”‚                              â”‚    â”‚
â”‚  â”‚  Node.js    â”‚  â”‚      Node.js                 â”‚    â”‚
â”‚  â”‚  Alpine     â”‚  â”‚      Alpine                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ PostgreSQL  â”‚  â”‚    Redis    â”‚                     â”‚
â”‚  â”‚  Container  â”‚  â”‚  Container  â”‚                     â”‚
â”‚  â”‚             â”‚  â”‚             â”‚                     â”‚
â”‚  â”‚  Postgres   â”‚  â”‚   Redis     â”‚                     â”‚
â”‚  â”‚  16-alpine  â”‚  â”‚  7-alpine   â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                         â”‚
â”‚  Volumes:                                               â”‚
â”‚  â€¢ postgres-data  (persistent database)                 â”‚
â”‚  â€¢ redis-data     (persistent cache)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Docker Build Process (Multi-Stage)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 1: Builder                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FROM node:20-alpine3.18                       â”‚
â”‚                                                â”‚
â”‚  1. Copy shared/ folder                        â”‚
â”‚  2. Copy service package.json                  â”‚
â”‚  3. Install ALL dependencies (dev + prod)      â”‚
â”‚  4. Copy source code                           â”‚
â”‚  5. Run TypeScript compiler (tsc)              â”‚
â”‚  6. Generate dist/ folder                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”‚ Copy dist/
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Stage 2: Production                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FROM node:20-alpine3.18                       â”‚
â”‚                                                â”‚
â”‚  1. Create non-root user                       â”‚
â”‚  2. Copy package.json                          â”‚
â”‚  3. Install ONLY production dependencies       â”‚
â”‚  4. Copy compiled code from builder            â”‚
â”‚  5. Generate Prisma Client                     â”‚
â”‚  6. Set user to non-root                       â”‚
â”‚  7. Expose port                                â”‚
â”‚  8. CMD ["npm", "start"]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
         Optimized Image
         (smaller, secure)
```

---

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Security Measures               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  1. Network Level                       â”‚
â”‚     â€¢ Docker internal network           â”‚
â”‚     â€¢ Services not exposed externally   â”‚
â”‚     â€¢ Only gateway has public access    â”‚
â”‚                                         â”‚
â”‚  2. Application Level                   â”‚
â”‚     â€¢ JWT token validation              â”‚
â”‚     â€¢ Helmet.js security headers        â”‚
â”‚     â€¢ CORS configuration                â”‚
â”‚     â€¢ Input validation (Joi)            â”‚
â”‚                                         â”‚
â”‚  3. Database Level                      â”‚
â”‚     â€¢ Prisma ORM (prevents SQL inject)  â”‚
â”‚     â€¢ Schema separation per service     â”‚
â”‚     â€¢ Password hashing (bcrypt)         â”‚
â”‚                                         â”‚
â”‚  4. Container Level                     â”‚
â”‚     â€¢ Non-root user execution           â”‚
â”‚     â€¢ Minimal Alpine images             â”‚
â”‚     â€¢ Multi-stage builds                â”‚
â”‚     â€¢ Read-only file systems (TODO)     â”‚
â”‚                                         â”‚
â”‚  5. Configuration Level                 â”‚
â”‚     â€¢ Environment variables             â”‚
â”‚     â€¢ Secrets management (TODO)         â”‚
â”‚     â€¢ No hardcoded credentials          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¦ Health Check Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Docker Compose Health Checks               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  1. PostgreSQL                               â”‚
â”‚     Command: pg_isready                      â”‚
â”‚     Interval: 10s                            â”‚
â”‚     Status: Must be healthy first            â”‚
â”‚     â†“                                        â”‚
â”‚                                              â”‚
â”‚  2. Redis                                    â”‚
â”‚     Command: redis-cli ping                  â”‚
â”‚     Interval: 10s                            â”‚
â”‚     Status: Must be healthy first            â”‚
â”‚     â†“                                        â”‚
â”‚                                              â”‚
â”‚  3. Services (parallel)                      â”‚
â”‚     Auth, User, Note, Tag                    â”‚
â”‚     Command: wget /health                    â”‚
â”‚     Depends on: Postgres                     â”‚
â”‚     â†“                                        â”‚
â”‚                                              â”‚
â”‚  4. API Gateway (last)                       â”‚
â”‚     Command: wget /health                    â”‚
â”‚     Depends on: All services                 â”‚
â”‚     â†“                                        â”‚
â”‚                                              â”‚
â”‚  âœ… All systems operational                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ Scaling Strategy (Future)

```
Current: Single instance per service
Future: Horizontal scaling with Kubernetes

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Load Balancer / Ingress         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Gateway-1â”‚       â”‚Gateway-2â”‚  (Auto-scaled)
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚                 â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼         â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Auth-1  â”‚ â”‚Auth-2  â”‚ â”‚Auth-3  â”‚  (3 replicas)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“         â†“         â†“
  Database Cluster
```

---

## ğŸ¯ Port Mapping

```
External Port â†’ Internal Port
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
8080          â†’ API Gateway
3001          â†’ Auth Service
3002          â†’ User Service
3003          â†’ Note Service
3004          â†’ Tag Service
5432          â†’ PostgreSQL
6379          â†’ Redis

Internal Only:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Services communicate via Docker network
using service names (e.g., http://auth-service:3001)
```

---

This architecture provides:
âœ… Service isolation
âœ… Scalability
âœ… Maintainability
âœ… Security
âœ… Easy deployment
âœ… Development flexibility
